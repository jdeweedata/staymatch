# Complex Feature Spec Example

**Feature**: Implement real-time chat support with AI assistant
**Complexity**: Complex (55+ points)
**Generated By**: PM Agent

## Overview

This example demonstrates PM Agent output for a complex feature that requires:
- 15+ new files
- Significant database changes (5+ tables)
- 10+ API endpoints
- Real-time WebSocket infrastructure
- AI integration
- Multiple user roles (customer, agent, admin)
- High risk

## Files in This Example

| File | Description |
|------|-------------|
| `SPEC.md` | Full specification with user stories |
| `TASKS.md` | Task breakdown by agent role |
| `PROGRESS.md` | Progress tracking template |
| `architecture.md` | Technical architecture documentation |

## Estimation Breakdown

| Component | Points |
|-----------|--------|
| Database schema (5 tables) | 8 |
| Real-time infrastructure | 13 |
| AI integration | 13 |
| Customer chat widget | 8 |
| Agent dashboard | 13 |
| Ticket management | 8 |
| Admin configuration | 5 |
| Testing | 8 |
| Documentation | 3 |
| **Total** | **79** |

## Usage

This example was generated with:

```bash
/generate-spec "Implement real-time chat support system with AI assistant integration, ticket management, agent dashboard, chat history, and multi-channel support"
```

Or via CLI:

```bash
npx ts-node scripts/agents/pm-cli.ts generate "Implement real-time chat support with AI assistant" --priority high
```

## Key Characteristics

- **Multi-phase implementation**: 3-4 week sprint
- **New infrastructure**: WebSocket server, AI API
- **Multiple user interfaces**: Customer widget, agent dashboard, admin panel
- **Real-time requirements**: Live chat, presence, typing indicators
- **AI capabilities**: Auto-responses, ticket classification, sentiment analysis
- **Data persistence**: Chat history, transcripts, analytics

## Task Groups

### Phase 1: Infrastructure (Week 1)

1. **Database Engineer** (8 points)
   - Create chat_sessions table
   - Create chat_messages table
   - Create chat_agents table
   - Create chat_tickets table
   - Create ai_responses table
   - Indexes and RLS policies

2. **Backend Engineer** (13 points)
   - WebSocket server setup
   - Real-time message handling
   - Presence system
   - Session management

### Phase 2: AI Integration (Week 2)

3. **Backend Engineer** (13 points)
   - AI provider integration (Claude/GPT)
   - Response generation service
   - Ticket classification
   - Sentiment analysis

### Phase 3: Frontend (Weeks 2-3)

4. **Frontend Engineer** (8 points)
   - Customer chat widget
   - Embeddable component
   - Mobile responsive

5. **Frontend Engineer** (13 points)
   - Agent dashboard
   - Multi-chat management
   - Quick responses
   - Customer context panel

6. **Frontend Engineer** (8 points)
   - Ticket management UI
   - Queue management
   - Escalation workflow

### Phase 4: Polish (Week 4)

7. **Frontend Engineer** (5 points)
   - Admin configuration
   - AI settings
   - Agent management

8. **Testing Engineer** (8 points)
   - Unit tests
   - Integration tests
   - E2E chat flow tests
   - Load testing

9. **Ops Engineer** (3 points)
   - Monitoring setup
   - Alert configuration
   - Performance optimization

## Architecture

```
┌─────────────────┐     ┌─────────────────┐
│  Customer Site  │────▶│  Chat Widget    │
└─────────────────┘     └────────┬────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────┐
│           WebSocket Server              │
│  ┌───────────┐  ┌───────────────────┐  │
│  │  Presence │  │  Message Router   │  │
│  └───────────┘  └───────────────────┘  │
└─────────────────────────────────────────┘
         │                    │
         ▼                    ▼
┌─────────────────┐   ┌─────────────────┐
│   AI Service    │   │  Agent Dashboard│
│  ┌───────────┐  │   │  ┌───────────┐  │
│  │  Claude   │  │   │  │  React    │  │
│  └───────────┘  │   │  └───────────┘  │
└─────────────────┘   └─────────────────┘
         │
         ▼
┌─────────────────────────────────────────┐
│              Supabase                    │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │Sessions │  │Messages │  │Tickets  │ │
│  └─────────┘  └─────────┘  └─────────┘ │
└─────────────────────────────────────────┘
```

## Risk Assessment

- **Risk Level**: High
- **Risk Factors**:
  - New real-time infrastructure
  - AI API costs and latency
  - Scalability under load
  - Data privacy (chat logs)
  - Agent training/onboarding
- **Mitigations**:
  - Use Supabase Realtime for WebSockets
  - AI response caching
  - Rate limiting
  - Encryption at rest
  - Comprehensive documentation

## Dependencies

| Package | Purpose |
|---------|---------|
| `@supabase/realtime` | WebSocket connections |
| `@anthropic-ai/sdk` | AI responses |
| `@tanstack/react-query` | Data fetching |
| `framer-motion` | Animations |
| `date-fns` | Time formatting |

## Success Criteria

- [ ] Customer can initiate chat from any page
- [ ] AI responds within 2 seconds
- [ ] Agent can manage 5+ simultaneous chats
- [ ] Chat history persisted and searchable
- [ ] Ticket creation from chat working
- [ ] 99.9% uptime for real-time services
